# 1. Bloquear acceso a la carpeta .git y archivos de sistema
<FilesMatch "^(\.git|\.htaccess|.*\.json|error_log|README\.md)$">
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order allow,deny
        Deny from all
    </IfModule>
</FilesMatch>

# 2. Desactivar el listado de directorios (evita que vean tus carpetas)
Options -Indexes

# --- Reglas originales abajo ---
# 3. Bloquear intentos de inyecci贸n de scripts y variables globales
<IfModule mod_rewrite.c>
    RewriteCond %{QUERY_STRING} (<|%3C).*script.*(>|%3E) [NC,OR]
    RewriteCond %{QUERY_STRING} GLOBALS(=|\[|\%[0-9A-Z]{0,2}) [OR]
    RewriteCond %{QUERY_STRING} _REQUEST(=|\[|\%[0-9A-Z]{0,2})
    RewriteRule ^(.*)$ index.php [F,L]
</IfModule>

# 4. Proteger archivos de configuraci贸n de PHP y Logs
<FilesMatch "\.(php|ini|log)$">
    <Files "config.php">
        Require all denied
    </Files>
    <Files "php.ini">
        Require all denied
    </Files>
</FilesMatch>

# 5. Bloquear la ejecuci贸n de PHP en directorios de recursos
# Esto evita que un virus camuflado como imagen se ejecute
<IfModule mod_rewrite.c>
    RewriteCond %{REQUEST_FILENAME} \.php$
    RewriteCond %{REQUEST_URI} ^/(styles|img|english|francais)/ [NC]
    RewriteRule .* - [F,L]
</IfModule>

# 6. Protecci贸n adicional contra sniffing de tipos MIME
<IfModule mod_headers.c>
    Header set X-Content-Type-Options "nosniff"
</IfModule>
